{% extends "admin/change_list.html" %}
{% load static %}

{% block content %}
    <h2>Dashboard de Ventas</h2>

    <!-- Formulario de filtros -->
    <form method="get">
        <label for="mes">Mes:</label>
        <select name="mes" id="mes">
            <option value="1" {% if mes == 1 %}selected{% endif %}>Enero</option>
            <option value="2" {% if mes == 2 %}selected{% endif %}>Febrero</option>
            <option value="3" {% if mes == 3 %}selected{% endif %}>Marzo</option>
            <option value="4" {% if mes == 4 %}selected{% endif %}>Abril</option>
            <option value="5" {% if mes == 5 %}selected{% endif %}>Mayo</option>
            <option value="6" {% if mes == 6 %}selected{% endif %}>Junio</option>
            <option value="7" {% if mes == 7 %}selected{% endif %}>Julio</option>
            <option value="8" {% if mes == 8 %}selected{% endif %}>Agosto</option>
            <option value="9" {% if mes == 9 %}selected{% endif %}>Septiembre</option>
            <option value="10" {% if mes == 10 %}selected{% endif %}>Octubre</option>
            <option value="11" {% if mes == 11 %}selected{% endif %}>Noviembre</option>
            <option value="12" {% if mes == 12 %}selected{% endif %}>Diciembre</option>
        </select>

        <label for="anio">Año:</label>
        <select name="anio" id="anio">
            <option value="2023" {% if anio == 2023 %}selected{% endif %}>2023</option>
            <option value="2024" {% if anio == 2024 %}selected{% endif %}>2024</option>
            <option value="2025" {% if anio == 2025 %}selected{% endif %}>2025</option>
        </select>

        <label for="tipo">Mostrar por:</label>
        <select name="tipo" id="tipo">
            <option value="mes" {% if tipo == 'mes' %}selected{% endif %}>Mes</option>
            <option value="anio" {% if tipo == 'anio' %}selected{% endif %}>Año</option>
        </select>

        <button type="submit">Filtrar</button>
    </form>

    <canvas id="ventasChart" width="400" height="200"></canvas>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        const ctx = document.getElementById('ventasChart').getContext('2d');
        const ventasChart = new Chart(ctx, {
            type: 'line',  // Cambia esto a 'bar' si prefieres barras
            data: {
                labels: {{ labels|safe }},
                datasets: [{
                    label: 'Ventas Totales',
                    data: {{ data|safe }},
                    borderColor: 'rgba(75, 192, 192, 1)',
                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });
    </script>
{% endblock %}
